<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2025-06-16" />
  <title>gwArsenicR: An R package for modeling health effects of groundwater arsenic exposure</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">gwArsenicR: An R package for modeling health effects
of groundwater arsenic exposure</h1>
<p class="date">16 June 2025</p>
</header>
<h1 id="summary">Summary</h1>
<p>gwArsenicR is an R package [<span class="citation"
data-cites="R-base">R Core Team (2024)</span>] that provides a
streamlined workflow for epidemiologists and public health researchers
to estimate arsenic exposure from private and public well water and to
assess its association with various health outcomes. The package
implements a sophisticated statistical approach that combines geospatial
arsenic prediction models with a multiple imputation framework to
account for exposure uncertainty. The core functionality integrates
predicted arsenic concentration probabilities from U.S. Geological
Survey (USGS) models for private wells with U.S. Environmental
Protection Agency (EPA) data for public water systems. It then uses a
weighting scheme based on the proportion of the population served by
each water source to create a unified, county-level exposure probability
distribution. By encapsulating these complex methodologies into a
single, user-friendly function, gwArsenicR makes this type of analysis
more accessible, reproducible, and standardized.</p>
<h1 id="statement-of-need">Statement of Need</h1>
<p>Chronic exposure to arsenic in drinking water is a significant public
health problem, linked to a range of adverse health outcomes. Assessing
this risk is challenging, particularly for the estimated 40 million
Americans who rely on unregulated private wells [<span class="citation"
data-cites="DeSimone-2015">DeSimone, McMahon, and Rosen (2015)</span>].
Foundational studies by <span class="citation"
data-cites="Bulka-2022">Bulka et al. (2022)</span> and <span
class="citation" data-cites="Lombard-2021">Lombard et al. (2021)</span>
have established robust methodologies for this purpose, but their
implementation requires specialized expertise in data integration,
statistical modeling, and computational methods. This presents a
significant barrier for many environmental health researchers who may
lack the necessary programming skills to replicate or adapt these
complex analyses.</p>
<p>gwArsenicR directly addresses this need by packaging the entire
analytical pipeline into an easy-to-use R function. It automates the
process of:</p>
<ol type="1">
<li>Converting lognormal EPA arsenic data to a multinomial
distribution.<br />
</li>
<li>Combining USGS and EPA models based on population-use weights.<br />
</li>
<li>Performing multiple imputation to manage exposure uncertainty.<br />
</li>
<li>Fitting mixed-effects regression models to health data.<br />
</li>
<li>Pooling results according to Rubin’s Rules [<span class="citation"
data-cites="Rubin-1987">Rubin (1987)</span>].</li>
</ol>
<p>By providing this accessible tool, gwArsenicR lowers the barrier to
entry for conducting high-quality research on the health impacts of
groundwater contaminants, promoting reproducibility and wider
application of these state-of-the-art methods in environmental
epidemiology.</p>
<h1 id="design-and-features">Design and Features</h1>
<p>The design of gwArsenicR prioritizes ease of use, flexibility, and
statistical rigor.</p>
<ul>
<li><strong>Modular Architecture</strong>: The package is centered
around a primary function, perform_sensitivity_analysis(), which
orchestrates the entire workflow. This function calls internal helpers
for specific tasks, such as the regression_analysis() function, which
handles model fitting and the pooling of results. This modularity makes
the code base easier to maintain and extend.<br />
</li>
<li><strong>Flexible Parameterization</strong>: Users have control over
key aspects of the analysis. They can specify the number of imputation
draws (ndraws), define the health outcomes (targets) and covariates
through a standard R formula (regression_formula), and adjust the
standard deviation of the lognormal distribution (epa_lognormal_sdlog)
for the EPA data, allowing for tailored sensitivity analyses.<br />
</li>
<li><strong>Efficient Data Handling</strong>: The package leverages the
data.table package for fast and memory-efficient loading and processing
of large datasets, which is crucial when working with national-scale
health and environmental data.<br />
</li>
<li><strong>Statistically Robust Modeling</strong>: gwArsenicR uses the
lme4 package to fit linear mixed-effects models, allowing researchers to
properly account for hierarchical data structures (e.g., individuals
within counties, counties within states). The use of Amelia [<span
class="citation" data-cites="Amelia-2011">Honaker, King, and Blackwell
(2011)</span>] ensures that results from the multiple imputations are
pooled correctly according to Rubin’s Rules.</li>
</ul>
<h1 id="research-enabled-by-gwarsenicr"><strong>Research Enabled by
gwArsenicR</strong></h1>
<p>By simplifying a complex analytical workflow, gwArsenicR can
accelerate and broaden the scope of research in environmental health.
The package enables researchers to:</p>
<ul>
<li><strong>Rapidly Test Hypotheses</strong>: Easily investigate the
health effects of arsenic exposure on a wide range of outcomes, such as
birth weight, gestational age, cancer incidence, or cardiovascular
disease, using large, nationally representative datasets.<br />
</li>
<li><strong>Conduct Subgroup Analyses</strong>: Modify the regression
formula to explore whether associations differ across specific
subpopulations (e.g., by race/ethnicity, socioeconomic status, or
geographic region), which can help identify vulnerable groups.<br />
</li>
<li><strong>Inform Public Health Policy</strong>: Generate robust
evidence that can inform policy decisions, such as establishing
state-level guidelines for private well testing or targeting public
health interventions in high-risk areas.<br />
</li>
<li><strong>Serve as a Methodological Template</strong>: The package’s
framework can be adapted to study other environmental contaminants where
exposure data is uncertain and requires integration from multiple
sources.</li>
</ul>
<p>Ultimately, gwArsenicR empowers a wider research community to
contribute to our understanding of the health risks posed by groundwater
contaminants, fostering more timely and impactful science.</p>
<h1 id="acknowledgments">Acknowledgments</h1>
<p>This work was supported by the National Institutes of Health (NIH).
We thank the authors of the original studies for their foundational
work.</p>
<h1 class="unnumbered" id="references">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-Bulka-2022" class="csl-entry" role="listitem">
Bulka, Catherine M., Molly Scannell Bryan, Melissa A. Lombard, Scott M.
Bartell, Daniel K. Jones, Paul M. Bradley, Veronica M. Vieira, et al.
2022. <span>“Arsenic in Private Well Water and Birth Outcomes in the
United States.”</span> <em>Environment International</em> 163: 107176.
<a
href="https://doi.org/10.1016/j.envint.2022.107176">https://doi.org/10.1016/j.envint.2022.107176</a>.
</div>
<div id="ref-DeSimone-2015" class="csl-entry" role="listitem">
DeSimone, L. A., P. B. McMahon, and M. R. Rosen. 2015. <span>“The
Quality of Our Nation’s Waters: Water Quality in Principal Aquifers of
the United States, 1991-2010.”</span> <em>U.S. Geological Survey
Circular 1360</em>, 151. <a
href="https://doi.org/10.3133/cir1360">https://doi.org/10.3133/cir1360</a>.
</div>
<div id="ref-Amelia-2011" class="csl-entry" role="listitem">
Honaker, James, Gary King, and Matthew Blackwell. 2011. <span>“Amelia
II: A Program for Missing Data.”</span> <em>Journal of Statistical
Software</em> 45 (7): 1–47. <a
href="https://doi.org/10.18637/jss.v045.i07">https://doi.org/10.18637/jss.v045.i07</a>.
</div>
<div id="ref-Lombard-2021" class="csl-entry" role="listitem">
Lombard, Melissa A., Molly Scannell Bryan, Daniel K. Jones, Catherine
Bulka, Paul M. Bradley, Lorraine C. Backer, Michael J. Focazio, et al.
2021. <span>“Machine Learning Models of Arsenic in Private Wells
Throughout the Conterminous United States as a Tool for Exposure
Assessment in Human Health Studies.”</span> <em>Environmental Science
&amp; Technology</em> 55 (8): 5012–23. <a
href="https://doi.org/10.1021/acs.est.0c05239">https://doi.org/10.1021/acs.est.0c05239</a>.
</div>
<div id="ref-R-base" class="csl-entry" role="listitem">
R Core Team. 2024. <em>R: A Language and Environment for Statistical
Computing</em>. Vienna, Austria: R Foundation for Statistical Computing.
<a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-Rubin-1987" class="csl-entry" role="listitem">
Rubin, Donald B. 1987. <em>Multiple Imputation for Nonresponse in
Surveys</em>. New York: John Wiley &amp; Sons. <a
href="https://doi.org/10.1002/9780470316696">https://doi.org/10.1002/9780470316696</a>.
</div>
</div>
</body>
</html>

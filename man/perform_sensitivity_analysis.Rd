% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gwArsenic.R
\name{perform_sensitivity_analysis}
\alias{perform_sensitivity_analysis}
\title{Perform Sensitivity Analysis for Arsenic Exposure}
\usage{
perform_sensitivity_analysis(
  ndraws = 10,
  as_usgs_prob_csv = NULL,
  as_epa_prob_csv = NULL,
  birth_data_txt = NULL,
  regression_formula = NULL,
  output_dir = "sensitivity_results/",
  targets = c("OEGEST", "BWT"),
  impute_vars = NULL,
  as_cat_label = c("As<5", "As5-10", "As10+"),
  drop_as_cat_label_reg = c("As<5"),
  columns_to_select = NULL,
  rucc_col = "RUCC",
  geod_col = "GEOID10",
  as_conc_cols = c("RFC3_C1v2", "RFC3_C2v2", "RFC3_C3v2"),
  pop_well_col = "Wells_2010",
  birth_county_col = "FIPS",
  as_level_col = "AsLevel",
  epa_as_col = "EPA_AS_meanlog",
  epa_lognormal_sdlog = 1,
  epa_pwell_col = "PWELL_private_pct",
  seed = 12345,
  mice_m = 1,
  mice_maxit = 5,
  mice_method = "pmm",
  mice_covs = c("RUCC", "pm")
)
}
\arguments{
\item{ndraws}{An integer specifying the number of imputed datasets to
generate.}

\item{as_usgs_prob_csv}{A file path to the CSV containing USGS model-based
multinomial probabilities of arsenic levels for private wells.}

\item{as_epa_prob_csv}{A file path to the CSV containing EPA model-based
lognormal parameters for public wells and the percentage of private well
users.}

\item{birth_data_txt}{A file path to the text file containing the birth data.}

\item{regression_formula}{A string or formula object for the regression
model.}

\item{output_dir}{A file path to the directory where output files will be
saved.}

\item{targets}{A character vector of the dependent variables (health
outcomes) for the regression analysis. Defaults to c("OEGEST", "BWT").}

\item{impute_vars}{A character vector of column names to be imputed using
MICE. If NULL, no additional imputation is performed. Defaults to NULL.}

\item{as_cat_label}{A character vector of labels for the arsenic
concentration categories. Defaults to c("As<5", "As5-10", "As10+").}

\item{drop_as_cat_label_reg}{A character vector of arsenic categories to be
used as the reference level in the regression. Defaults to c("As<5").}

\item{columns_to_select}{A character vector of column names to be selected
from the birth data. If NULL, all columns are used.}

\item{rucc_col}{A character string specifying the column name for the
Rural-Urban Continuum Code. Defaults to "RUCC".}

\item{geod_col}{A character string specifying the column name for the
Geographic Identifier (e.g., county FIPS code) in the arsenic data.
Defaults to "GEOID10".}

\item{as_conc_cols}{A character vector of column names from the USGS data
for the arsenic concentration probabilities. Defaults to
c("RFC3_C1v2", "RFC3_C2v2", "RFC3_C3v2").}

\item{pop_well_col}{A character string specifying the column name from the
USGS data for the population of well users. Defaults to "Wells_2010".}

\item{birth_county_col}{A character string specifying the column name for
the birth county FIPS code in the birth data. Defaults to "FIPS".}

\item{as_level_col}{A character string for the name of the imputed arsenic
level column. Defaults to "AsLevel".}

\item{epa_as_col}{A character string for the column name of the EPA arsenic
lognormal meanlog parameter. Defaults to "EPA_AS_meanlog".}

\item{epa_lognormal_sdlog}{A numeric value for the standard deviation of the
lognormal distribution for the EPA data. Defaults to 1.0.}

\item{epa_pwell_col}{A character string for the column name of the
percentage of private well users. Defaults to "PWELL_private_pct".}

\item{seed}{An integer for setting the random number generator seed for
reproducibility. Defaults to 12345.}

\item{mice_m}{An integer for the number of multiple imputations for
covariates. Defaults to 1.}

\item{mice_maxit}{An integer for the maximum number of iterations for mice.
Defaults to 5.}

\item{mice_method}{A character string specifying the imputation method for
covariates. Defaults to "pmm" (predictive mean matching).}

\item{mice_covs}{A character vector of column names to be used as
covariates in the mice imputation process. Defaults to c("RUCC", "pm").
Make sure these columns exist in the birth data.}
}
\value{
A list of data frames, each containing the pooled regression results
for a target health outcome.
}
\description{
This function performs a sensitivity analysis to assess the impact of arsenic
exposure from private wells on specified health outcomes. It integrates data
from USGS (private wells) and EPA (public wells) models to create a
probabilistic model of arsenic exposure, weighted by the proportion of the
population using each water source. It then uses multiple imputation to
generate a series of datasets with imputed arsenic levels.
}
\examples{
\dontrun{
# Basic usage with minimal parameters
results <- perform_sensitivity_analysis(
  ndraws = 10,
  as_usgs_prob_csv = "usgs_arsenic_probs.csv",
  as_epa_prob_csv = "epa_arsenic_params.csv",
  birth_data_txt = "birth_outcomes.txt",
  regression_formula = "~ AsLevel + maternal_age + (1|county)",
  output_dir = "results/",
  targets = c("birth_weight", "gestational_age")
)

# Advanced usage with custom parameters and MICE imputation
results <- perform_sensitivity_analysis(
  ndraws = 100,
  as_usgs_prob_csv = "data/usgs_probs.csv",
  as_epa_prob_csv = "data/epa_params.csv",
  birth_data_txt = "data/births.txt",
  regression_formula = "~ AsLevel + MAGE_R + rural + (1|FIPS)",
  output_dir = "sensitivity_results/",
  targets = c("OEGEST", "BWT"),
  impute_vars = c("MAGE_R", "education"),
  mice_m = 5,
  mice_maxit = 10,
  seed = 42
)
}

}
